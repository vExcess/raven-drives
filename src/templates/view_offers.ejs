<h1>Open Offers</h1>
<div class="listing-container">
    <div style="text-align: center; color: #aaa; margin-top: 50px;">
        <p>Loading offers...</p>
        <p>No open offers currently available. Be the first to post one!</p>
        <a href="{{ url_for('offer') }}" class="btn mt-4">Post an Offer</a>
    </div>
</div>

<script>
function renderOffers(offers) {
    offers.forEach(offer => {
        let el = document.createElement("div");
        el.innerHTML = `<div class="listing-card">
            <div class="listing-details">
                <h3>${ offer['pickup_location'] } &rarr; ${ offer['dropoff_location'] }</h3>
                <div class="listing-meta">
                    <strong>Pickup:</strong> ${ offer['pickup_time'].replace('T', ' ') }<br>
                    <strong>Dropoff:</strong> ${ offer['dropoff_time'].replace('T', ' ') }
                    <br>
                    <small>Posted by: ${ offer['display_name'] } (<a href="mailto:${ offer['email'] }">Contact</a>)</small>
                </div>
            </div>
            <div class="listing-price">
                ${ offer['price'] }
            </div>
        </div>`;
        document.body.append(el);
    });
    
}

fetch("/API/offers")
    .then(res => res.json())
    .then(renderOffers);
</script>